Calendar=function(_1,_2,_3,_4){this.activeDiv=null;this.currentDateEl=null;this.getDateStatus=null;this.getDateToolTip=null;this.getDateText=null;this.timeout=null;this.onSelected=_3||null;this.onClose=_4||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT["DEF_DATE_FORMAT"];this.ttDateFormat=Calendar._TT["TT_DATE_FORMAT"];this.isPopup=true;this.weekNumbers=true;this.firstDayOfWeek=typeof _1=="number"?_1:Calendar._FD;this.showsOtherMonths=false;this.dateStr=_2;this.ar_days=null;this.showsTime=false;this.time24=true;this.yearStep=2;this.hiliteToday=true;this.multiple=null;this.yearButtons=false;this.todayButton=false;this.firstDayButtons=false;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined"){Calendar._SDN_len=3;}var ar=new Array();for(var i=8;i>0;){ar[--i]=Calendar._DN[i].substr(0,Calendar._SDN_len);}Calendar._SDN=ar;if(typeof Calendar._SMN_len=="undefined"){Calendar._SMN_len=3;}ar=new Array();for(var i=12;i>0;){ar[--i]=Calendar._MN[i].substr(0,Calendar._SMN_len);}Calendar._SMN=ar;}};Calendar._C=null;Calendar.is_ie=(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent));Calendar.is_ie5=(Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent));Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.getAbsolutePos=function(el){var SL=0,ST=0;var _9=/^div$/i.test(el.tagName);if(_9&&el.scrollLeft){SL=el.scrollLeft;}if(_9&&el.scrollTop){ST=el.scrollTop;}var r={x:el.offsetLeft-SL,y:el.offsetTop-ST};if(el.offsetParent){var _b=this.getAbsolutePos(el.offsetParent);r.x+=_b.x;r.y+=_b.y;}return r;};Calendar.isRelated=function(el,_d){var _e=_d.relatedTarget;if(!_e){var _f=_d.type;if(_f=="mouseover"){_e=_d.fromElement;}else{if(_f=="mouseout"){_e=_d.toElement;}}}while(_e){if(_e==el){return true;}if(!Calendar.is_ie){try{if(!_e.parentNode){this._mouseover_list=false;this._handleBlurTimer(true,100);this.tryFocus();}}catch(e){return false;}}_e=_e.parentNode;}return false;};Calendar.removeClass=function(el,_11){if(!(el&&el.className)){return;}var cls=el.className.split(" ");var ar=new Array();for(var i=cls.length;i>0;){if(cls[--i]!=_11){ar[ar.length]=cls[i];}}el.className=ar.join(" ");};Calendar.addClass=function(el,_16){Calendar.removeClass(el,_16);el.className+=" "+_16;};Calendar.getElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.currentTarget;while(f.nodeType!=1||/^div$/i.test(f.tagName)){f=f.parentNode;}return f;};Calendar.getTargetElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.target;while(f.nodeType!=1){f=f.parentNode;}return f;};Calendar.stopEvent=function(ev){ev||(ev=window.event);if(Calendar.is_ie){ev.cancelBubble=true;ev.returnValue=false;}else{ev.preventDefault();ev.stopPropagation();}return false;};Calendar.addEvent=function(el,_1d,_1e){if(el.attachEvent){el.attachEvent("on"+_1d,_1e);}else{if(el.addEventListener){el.addEventListener(_1d,_1e,true);}else{el["on"+_1d]=_1e;}}};Calendar.removeEvent=function(el,_20,_21){if(el.detachEvent){el.detachEvent("on"+_20,_21);}else{if(el.removeEventListener){el.removeEventListener(_20,_21,true);}else{el["on"+_20]=null;}}};Calendar.createElement=function(_22,_23){var el=null;if(document.createElementNS){el=document.createElementNS("http://www.w3.org/1999/xhtml",_22);}else{el=document.createElement(_22);}if(typeof _23!="undefined"){_23.appendChild(el);}return el;};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true);}}};Calendar.findMonth=function(el){if(typeof el.month!="undefined"){return el;}else{if(typeof el.parentNode.month!="undefined"){return el.parentNode;}}return null;};Calendar.findYear=function(el){if(typeof el.year!="undefined"){return el;}else{if(typeof el.parentNode.year!="undefined"){return el.parentNode;}}return null;};Calendar.showMonthsCombo=function(){var cal=Calendar._C;if(!cal){return false;}var cal=cal;var cd=cal.activeDiv;var mc=cal.monthsCombo;if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}if(cal.activeMonth){Calendar.removeClass(cal.activeMonth,"active");}var mon=cal.monthsCombo.getElementsByTagName("div")[cal.date.getMonth()];Calendar.addClass(mon,"active");cal.activeMonth=mon;var s=mc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px";}else{var mcw=mc.offsetWidth;if(typeof mcw=="undefined"){mcw=50;}s.left=(cd.offsetLeft+cd.offsetWidth-mcw)+"px";}s.top=(cd.offsetTop+cd.offsetHeight)+"px";};Calendar.showYearsCombo=function(fwd){var cal=Calendar._C;if(!cal){return false;}var cal=cal;var cd=cal.activeDiv;var yc=cal.yearsCombo;if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}if(cal.activeYear){Calendar.removeClass(cal.activeYear,"active");}cal.activeYear=null;var Y=cal.date.getFullYear()+(fwd?1:-1);var yr=yc.firstChild;var _34=false;for(var i=12;i>0;--i){if(Y>=cal.minYear&&Y<=cal.maxYear){yr.innerHTML=Y;yr.year=Y;yr.style.display="block";_34=true;}else{yr.style.display="none";}yr=yr.nextSibling;Y+=fwd?cal.yearStep:-cal.yearStep;}if(_34){var s=yc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px";}else{var ycw=yc.offsetWidth;if(typeof ycw=="undefined"){ycw=50;}s.left=(cd.offsetLeft+cd.offsetWidth-ycw)+"px";}s.top=(cd.offsetTop+cd.offsetHeight)+"px";}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal){return false;}if(cal.timeout){clearTimeout(cal.timeout);}var el=cal.activeDiv;if(!el){return false;}var _3b=Calendar.getTargetElement(ev);ev||(ev=window.event);Calendar.removeClass(el,"active");if(_3b==el||_3b.parentNode==el){Calendar.cellClick(el,ev);}var mon=Calendar.findMonth(_3b);var _3d=null;if(mon){_3d=new Date(cal.date);if(mon.month!=_3d.getMonth()){_3d.setMonth(mon.month);cal.setDate(_3d);cal.dateClicked=false;cal.callHandler();}}else{var _3e=Calendar.findYear(_3b);if(_3e){_3d=new Date(cal.date);if(_3e.year!=_3d.getFullYear()){_3d.setFullYear(_3e.year);cal.setDate(_3d);cal.dateClicked=false;cal.callHandler();}}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev);}};Calendar.tableMouseOver=function(ev){var cal=Calendar._C;if(!cal){return;}var el=cal.activeDiv;var _42=Calendar.getTargetElement(ev);if(_42==el||_42.parentNode==el){Calendar.addClass(el,"hilite active");Calendar.addClass(el.parentNode,"rowhilite");}else{if(typeof el.navtype=="undefined"||(el.navtype!=50&&(el.navtype==0||Math.abs(el.navtype)>2))){Calendar.removeClass(el,"active");}Calendar.removeClass(el,"hilite");Calendar.removeClass(el.parentNode,"rowhilite");}ev||(ev=window.event);if(el.navtype==50&&_42!=el){var pos=Calendar.getAbsolutePos(el);var w=el.offsetWidth;var x=ev.clientX;var dx;var _47=true;if(x>pos.x+w){dx=x-pos.x-w;_47=false;}else{dx=pos.x-x;}if(dx<0){dx=0;}var _48=el._range;var _49=el._current;var _4a=Math.floor(dx/10)%_48.length;for(var i=_48.length;--i>=0;){if(_48[i]==_49){break;}}while(_4a-->0){if(_47){if(--i<0){i=_48.length-1;}}else{if(++i>=_48.length){i=0;}}}var _4c=_48[i];el.innerHTML=_4c;cal.onUpdateTime();}var mon=Calendar.findMonth(_42);if(mon){if(mon.month!=cal.date.getMonth()){if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}Calendar.addClass(mon,"hilite");cal.hilitedMonth=mon;}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}}}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}var _4e=Calendar.findYear(_42);if(_4e){if(_4e.year!=cal.date.getFullYear()){if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}Calendar.addClass(_4e,"hilite");cal.hilitedYear=_4e;}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}}}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}}}return Calendar.stopEvent(ev);};Calendar.tableMouseDown=function(ev){if(Calendar.getTargetElement(ev)==Calendar.getElement(ev)){return Calendar.stopEvent(ev);}};Calendar.calDragIt=function(ev){var cal=Calendar._C;if(!(cal&&cal.dragging)){return false;}var _52;var _53;if(Calendar.is_ie){_53=window.event.clientY+document.body.scrollTop;_52=window.event.clientX+document.body.scrollLeft;}else{_52=ev.pageX;_53=ev.pageY;}cal.hideShowCovered();var st=cal.element.style;st.left=(_52-cal.xOffs)+"px";st.top=(_53-cal.yOffs)+"px";return Calendar.stopEvent(ev);};Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal){return false;}cal.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev);}cal.hideShowCovered();};Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el._disabled){return false;}var cal=el.calendar;cal.activeDiv=el;Calendar._C=cal;if(el.navtype!=300){with(Calendar){if(el.navtype==50){el._current=el.innerHTML;addEvent(document,"mousemove",tableMouseOver);}else{addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver);}addClass(el,"hilite active");addEvent(document,"mouseup",tableMouseUp);}}else{if(cal.isPopup){cal._dragStart(ev);}}if(el.navtype==-1||el.navtype==1){if(cal.timeout){clearTimeout(cal.timeout);}cal.timeout=setTimeout("Calendar.showMonthsCombo()",250);}else{if(el.navtype==-2||el.navtype==2){if(cal.timeout){clearTimeout(cal.timeout);}cal.timeout=setTimeout((el.navtype>0)?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250);}else{cal.timeout=null;}}return Calendar.stopEvent(ev);};Calendar.dayMouseDblClick=function(ev){Calendar.cellClick(Calendar.getElement(ev),ev||window.event);if(Calendar.is_ie){document.selection.empty();}};Calendar.dayMouseOver=function(ev){var el=Calendar.getElement(ev);if(Calendar.isRelated(el,ev)||Calendar._C||(el._disabled&&!el.ttip)){return false;}if(el.ttip){if(el.ttip.substr(0,1)=="_"){el.ttip=el.caldate.print(el.calendar.ttDateFormat)+el.ttip.substr(1);}el.calendar.tooltips.innerHTML=el.ttip;}if(el.navtype!=300&&!el._disabled){Calendar.addClass(el,"hilite");if(el.caldate){Calendar.addClass(el.parentNode,"rowhilite");}}return Calendar.stopEvent(ev);};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||(el._disabled&&!el.ttip)){return false;}removeClass(el,"hilite");if(el.caldate){removeClass(el.parentNode,"rowhilite");}if(el.calendar){el.calendar.tooltips.innerHTML=_TT["SEL_DATE"];}return stopEvent(ev);}};Calendar.cellClick=function(el,ev){var cal=el.calendar;var _62=false;var _63=false;var _64=null;if(el._disabled){return;}if(typeof el.navtype=="undefined"){if(cal.currentDateEl){Calendar.removeClass(cal.currentDateEl,"selected");Calendar.addClass(el,"selected");_62=(cal.currentDateEl==el);if(!_62){cal.currentDateEl=el;}}cal.date.setDateOnly(el.caldate);_64=cal.date;var _65=!(cal.dateClicked=!el.otherMonth);if(!_65&&!cal.currentDateEl){cal._toggleMultipleDate(new Date(_64));}else{_63=!el._disabled;}if(_65){cal._init(cal.firstDayOfWeek,_64);}}else{if(el.navtype==200){Calendar.removeClass(el,"hilite");cal.callCloseHandler();return;}_64=new Date(cal.date);if(el.navtype==0){_64.setDateOnly(new Date());}cal.dateClicked=false;var _66=_64.getFullYear();var mon=_64.getMonth();function setMonth(m){var day=_64.getDate();var max=_64.getMonthDays(m);if(day>max){_64.setDate(max);}_64.setMonth(m);}switch(el.navtype){case 400:Calendar.removeClass(el,"hilite");var _6b=Calendar._TT["ABOUT"];if(typeof _6b!="undefined"){_6b+=cal.showsTime?Calendar._TT["ABOUT_TIME"]:"";}else{_6b="Help and about box text is not translated into this language.\n";}alert(_6b);return;case -2:if(_66>cal.minYear){_64.setFullYear(_66-1);}break;case -1:if(mon>0){setMonth(mon-1);}else{if(_66-->cal.minYear){_64.setFullYear(_66);setMonth(11);}}break;case 1:if(mon<11){setMonth(mon+1);}else{if(_66<cal.maxYear){_64.setFullYear(_66+1);setMonth(0);}}break;case 2:if(_66<cal.maxYear){_64.setFullYear(_66+1);}break;case 100:cal.setFirstDayOfWeek(el.fdow);return;case 50:var _6c=el._range;var _6d=el.innerHTML;for(var i=_6c.length;--i>=0;){if(_6c[i]==_6d){break;}}if(ev&&ev.shiftKey){if(--i<0){i=_6c.length-1;}}else{if(++i>=_6c.length){i=0;}}var _6f=_6c[i];el.innerHTML=_6f;cal.onUpdateTime();return;case 0:if((typeof cal.getDateStatus=="function")&&cal.getDateStatus(_64,_64.getFullYear(),_64.getMonth(),_64.getDate())){return false;}break;}if(!_64.equalsTo(cal.date)){cal.setDate(_64);_63=true;}else{if(el.navtype==0){_63=_62=true;}}}if(_63){ev&&cal.callHandler();}if(_62){Calendar.removeClass(el,"hilite");ev&&cal.callCloseHandler();}};Calendar.prototype.create=function(_70){var _71=null;if(!_70){_71=document.getElementsByTagName("body")[0];this.isPopup=true;}else{_71=_70;this.isPopup=false;}this.date=this.dateStr?new Date(this.dateStr):new Date();var _72=Calendar.createElement("table");this.table=_72;_72.cellSpacing=0;_72.cellPadding=0;_72.calendar=this;Calendar.addEvent(_72,"mousedown",Calendar.tableMouseDown);var div=Calendar.createElement("div");this.element=div;div.className="calendar";if(this.isPopup){div.style.position="absolute";div.style.display="none";}div.appendChild(_72);var _74=Calendar.createElement("thead",_72);var _75=null;var row=null;var cal=this;var hh=function(_79,cs,_7b){_75=Calendar.createElement("td",row);_75.colSpan=cs;_75.className="button";if(_7b!=0&&Math.abs(_7b)<=2){_75.className+=" nav";}Calendar._add_evs(_75);_75.calendar=cal;_75.navtype=_7b;_75.innerHTML="<div unselectable='on'>"+_79+"</div>";return _75;};row=Calendar.createElement("tr",_74);var _7c=6;(this.isPopup)&&--_7c;(this.weekNumbers)&&++_7c;this.titleleft=hh("&nbsp;",1,300);this.titleleft.className="title";this.title=hh("",_7c,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT["DRAG_TO_MOVE"];this.title.style.cursor="move";this.titleleft.ttip=Calendar._TT["DRAG_TO_MOVE"];this.titleleft.style.cursor="move";this.closebutton=hh("&nbsp;",1,200);this.closebutton.ttip=Calendar._TT["CLOSE"];this.closebutton.className="titleclose";}row=Calendar.createElement("tr",_74);row.className="headrow";if(this.yearButtons){this._nav_py=hh("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT["PREV_YEAR"];}this._nav_pm=hh("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT["PREV_MONTH"];if(this.yearButtons){if(this.todayButton){this._nav_now=hh(Calendar._TT["TODAY"],this.weekNumbers?4:3,0);}else{this._nav_now=Calendar.createElement("td",row);this._nav_now.colSpan=this.weekNumbers?4:3;}}else{if(this.todayButton){this._nav_now=hh(Calendar._TT["TODAY"],this.weekNumbers?6:5,0);}else{this._nav_now=Calendar.createElement("td",row);this._nav_now.colSpan=this.weekNumbers?6:5;}}if(this.todayButton){this._nav_now.ttip=Calendar._TT["GO_TODAY"];}this._nav_nm=hh("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT["NEXT_MONTH"];if(this.yearButtons){this._nav_ny=hh("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT["NEXT_YEAR"];}row=Calendar.createElement("tr",_74);row.className="daynames";if(this.weekNumbers){_75=Calendar.createElement("td",row);_75.className="name wn";_75.innerHTML=Calendar._TT["WK"];}for(var i=7;i>0;--i){_75=Calendar.createElement("td",row);if(!i){_75.calendar=this;if(this.firstDayButtons){_75.navtype=100;Calendar._add_evs(_75);}_75.calendar=this;}}this.firstdayname=(this.weekNumbers)?row.firstChild.nextSibling:row.firstChild;this._displayWeekdays();var _7e=Calendar.createElement("tbody",_72);this.tbody=_7e;for(i=6;i>0;--i){row=Calendar.createElement("tr",_7e);if(this.weekNumbers){_75=Calendar.createElement("td",row);}for(var j=7;j>0;--j){_75=Calendar.createElement("td",row);_75.calendar=this;Calendar._add_evs(_75);}}if(this.showsTime){row=Calendar.createElement("tr",_7e);row.className="time";_75=Calendar.createElement("td",row);_75.className="time";_75.colSpan=2;_75.innerHTML=Calendar._TT["TIME"]||"&nbsp;";_75=Calendar.createElement("td",row);_75.className="time";_75.colSpan=this.weekNumbers?4:3;(function(){function makeTimePart(_80,_81,_82,_83){var _84=Calendar.createElement("span",_75);_84.className=_80;_84.innerHTML=_81;_84.calendar=cal;_84.ttip=Calendar._TT["TIME_PART"];_84.navtype=50;_84._range=[];if(typeof _82!="number"){_84._range=_82;}else{for(var i=_82;i<=_83;++i){var txt;if(i<10&&_83>=10){txt="0"+i;}else{txt=""+i;}_84._range[_84._range.length]=txt;}}Calendar._add_evs(_84);return _84;}var hrs=cal.date.getHours();var _88=cal.date.getMinutes();var t12=!cal.time24;var pm=(hrs>12);if(t12&&pm){hrs-=12;}var H=makeTimePart("hour",hrs,t12?1:0,t12?12:23);var _8c=Calendar.createElement("span",_75);_8c.innerHTML=":";_8c.className="colon";var M=makeTimePart("minute",_88,0,59);var AP=null;_75=Calendar.createElement("td",row);_75.className="time";_75.colSpan=2;if(t12){AP=makeTimePart("ampm",pm?"pm":"am",["am","pm"]);}else{_75.innerHTML="&nbsp;";}cal.onSetTime=function(){var pm,hrs=this.date.getHours(),_88=this.date.getMinutes();if(t12){pm=(hrs>=12);if(pm){hrs-=12;}if(hrs==0){hrs=12;}AP.innerHTML=pm?"pm":"am";}H.innerHTML=(hrs<10)?("0"+hrs):hrs;M.innerHTML=(_88<10)?("0"+_88):_88;};cal.onUpdateTime=function(){var _90=this.date;var h=parseInt(H.innerHTML,10);if(t12){if(/pm/i.test(AP.innerHTML)&&h<12){h+=12;}else{if(/am/i.test(AP.innerHTML)&&h==12){h=0;}}}var d=_90.getDate();var m=_90.getMonth();var y=_90.getFullYear();_90.setHours(h);_90.setMinutes(parseInt(M.innerHTML,10));_90.setFullYear(y);_90.setMonth(m);_90.setDate(d);this.dateClicked=false;this.callHandler();};})();}else{this.onSetTime=this.onUpdateTime=function(){};}var _95=Calendar.createElement("tfoot",_72);row=Calendar.createElement("tr",_95);row.className="footrow";_75=hh(Calendar._TT["SEL_DATE"],this.weekNumbers?8:7,300);_75.className="ttip";if(this.isPopup){_75.ttip=Calendar._TT["DRAG_TO_MOVE"];_75.style.cursor="move";}this.tooltips=_75;div=Calendar.createElement("div",this.element);this.monthsCombo=div;div.className="combo";for(i=0;i<Calendar._MN.length;++i){var mn=Calendar.createElement("div");mn.className=Calendar.is_ie?"label-IEfix":"label";mn.month=i;mn.innerHTML=Calendar._SMN[i];div.appendChild(mn);}if(this.yearButtons){div=Calendar.createElement("div",this.element);this.yearsCombo=div;div.className="combo";for(i=12;i>0;--i){var yr=Calendar.createElement("div");yr.className=Calendar.is_ie?"label-IEfix":"label";div.appendChild(yr);}}this._init(this.firstDayOfWeek,this.date);_71.appendChild(this.element);};Calendar._keyEvent=function(ev){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple){return false;}(Calendar.is_ie)&&(ev=window.event);var act=(Calendar.is_ie||ev.type=="keypress"),K=ev.keyCode;if(ev.ctrlKey){switch(K){case 37:act&&Calendar.cellClick(cal._nav_pm);break;case 38:act&&Calendar.cellClick(cal._nav_py);break;case 39:act&&Calendar.cellClick(cal._nav_nm);break;case 40:act&&Calendar.cellClick(cal._nav_ny);break;default:return false;}}else{switch(K){case 32:Calendar.cellClick(cal._nav_now);break;case 27:act&&cal.callCloseHandler();break;case 37:case 38:case 39:case 40:if(act){var _9b,x,y,ne,el,step;_9b=K==37||K==38;step=(K==37||K==39)?1:7;function setVars(){el=cal.currentDateEl;var p=el.pos;x=p&15;y=p>>4;ne=cal.ar_days[y][x];}setVars();function prevMonth(){var _9d=new Date(cal.date);_9d.setDate(_9d.getDate()-step);cal.setDate(_9d);}function nextMonth(){var _9e=new Date(cal.date);_9e.setDate(_9e.getDate()+step);cal.setDate(_9e);}while(1){switch(K){case 37:if(--x>=0){ne=cal.ar_days[y][x];}else{x=6;K=38;continue;}break;case 38:if(--y>=0){ne=cal.ar_days[y][x];}else{prevMonth();setVars();}break;case 39:if(++x<7){ne=cal.ar_days[y][x];}else{x=0;K=40;continue;}break;case 40:if(++y<cal.ar_days.length){ne=cal.ar_days[y][x];}else{nextMonth();setVars();}break;}break;}if(ne){if(!ne._disabled){Calendar.cellClick(ne);}else{if(_9b){prevMonth();}else{nextMonth();}}}}break;case 13:if(act){Calendar.cellClick(cal.currentDateEl,ev);}break;default:return false;}}return Calendar.stopEvent(ev);};Calendar.prototype._init=function(_9f,_a0){var _a1=new Date(),TY=_a1.getFullYear(),TM=_a1.getMonth(),TD=_a1.getDate();this.table.style.visibility="hidden";var _a2=_a0.getFullYear();if(_a2<this.minYear){_a2=this.minYear;_a0.setFullYear(_a2);}else{if(_a2>this.maxYear){_a2=this.maxYear;_a0.setFullYear(_a2);}}this.firstDayOfWeek=_9f;this.date=new Date(_a0);if(this.date.getHours()==0&&this.date.getMinutes()==0&&this.date.getSeconds()==0){this.date.setHours(12);this.date.setMinutes(59);this.date.setSeconds(59);}var _a3=_a0.getMonth();var _a4=_a0.getDate();var _a5=_a0.getMonthDays();_a0.setDate(1);var _a6=(_a0.getDay()-this.firstDayOfWeek)%7;if(_a6<0){_a6+=7;}_a0.setDate(-_a6);_a0.setDate(_a0.getDate()+1);var row=this.tbody.firstChild;var MN=Calendar._SMN[_a3];var _a9=this.ar_days=new Array();var _aa=Calendar._TT["WEEKEND"];var _ab=this.multiple?(this.datesCells={}):null;for(var i=0;i<6;++i,row=row.nextSibling){var _ad=row.firstChild;if(this.weekNumbers){_ad.className="day wn";_ad.innerHTML=_a0.getWeekNumber();_ad=_ad.nextSibling;}row.className="daysrow";var _ae=false,iday,dpos=_a9[i]=[];for(var j=0;j<7;++j,_ad=_ad.nextSibling,_a0.setDate(iday+1)){iday=_a0.getDate();var _b0=_a0.getDay();_ad.className="day";_ad.pos=i<<4|j;dpos[j]=_ad;var _b1=(_a0.getMonth()==_a3);if(!_b1){if(this.showsOtherMonths){_ad.className+=" othermonth";_ad.otherMonth=true;}else{_ad.className="emptycell";_ad.innerHTML="&nbsp;";_ad._disabled=true;continue;}}else{_ad.otherMonth=false;_ae=true;}_ad._disabled=false;_ad.innerHTML=this.getDateText?this.getDateText(_a0,iday):iday;if(_ab){_ab[_a0.print("%Y%m%d")]=_ad;}if(this.getDateStatus){var _b2=this.getDateStatus(_a0,_a2,_a3,iday);if(this.getDateToolTip){var _b3=this.getDateToolTip(_a0,_a2,_a3,iday);if(_b3){_ad.ttip=_b3;}}if(_b2===true){_ad.className+=" disabled";_ad._disabled=true;}else{if(/disabled/i.test(_b2)){_ad._disabled=true;}_ad.className+=" "+_b2;}}if(!_ad._disabled){_ad.caldate=new Date(_a0);if(!this.getDateToolTip){_ad.ttip="_";}if(!this.multiple&&_b1&&iday==_a4&&this.hiliteToday){_ad.className+=" selected";this.currentDateEl=_ad;}if(_a0.getFullYear()==TY&&_a0.getMonth()==TM&&iday==TD){_ad.className+=" today";if(!this.getDateToolTip){_ad.ttip+=Calendar._TT["PART_TODAY"];}}if(_aa.indexOf(_b0.toString())!=-1){_ad.className+=_ad.otherMonth?" oweekend":" weekend";}}}if(!(_ae||this.showsOtherMonths)){row.className="emptyrow";}}this.title.innerHTML=Calendar._MN[_a3]+", "+_a2;this.onSetTime();this.table.style.visibility="visible";this._initMultipleDates();};Calendar.prototype._initMultipleDates=function(){if(this.multiple){for(var i in this.multiple){var _b5=this.datesCells[i];var d=this.multiple[i];if(!d){continue;}if(_b5){_b5.className+=" selected";}}}};Calendar.prototype._toggleMultipleDate=function(_b7){if(this.multiple){var ds=_b7.print("%Y%m%d");var _b9=this.datesCells[ds];if(_b9){var d=this.multiple[ds];if(!d){Calendar.addClass(_b9,"selected");this.multiple[ds]=_b7;}else{Calendar.removeClass(_b9,"selected");delete this.multiple[ds];}}}};Calendar.prototype.setDateToolTipHandler=function(_bb){this.getDateToolTip=_bb;};Calendar.prototype.setDate=function(_bc){if(!_bc.equalsTo(this.date)){this._init(this.firstDayOfWeek,_bc);}};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date);};Calendar.prototype.setFirstDayOfWeek=function(_bd){this._init(_bd,this.date);this._displayWeekdays();};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(_be){this.getDateStatus=_be;};Calendar.prototype.setRange=function(a,z){this.minYear=a;this.maxYear=z;};Calendar.prototype.callHandler=function(){if(this.onSelected){this.onSelected(this,this.date.print(this.dateFormat));}};Calendar.prototype.callCloseHandler=function(){if(this.onClose){this.onClose(this);}this.hideShowCovered();};Calendar.prototype.destroy=function(){var el=this.element.parentNode;el.removeChild(this.element);Calendar._C=null;window._dynarch_popupCalendar=null;};Calendar.prototype.reparent=function(_c2){var el=this.element;el.parentNode.removeChild(el);_c2.appendChild(el);};Calendar._checkCalendar=function(ev){var _c5=window._dynarch_popupCalendar;if(!_c5){return false;}var el=Calendar.is_ie?Calendar.getElement(ev):Calendar.getTargetElement(ev);for(;el!=null&&el!=_c5.element;el=el.parentNode){}if(el==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(ev);}};Calendar.prototype.show=function(){var _c7=this.table.getElementsByTagName("tr");for(var i=_c7.length;i>0;){var row=_c7[--i];Calendar.removeClass(row,"rowhilite");var _ca=row.getElementsByTagName("td");for(var j=_ca.length;j>0;){var _cc=_ca[--j];Calendar.removeClass(_cc,"hilite");Calendar.removeClass(_cc,"active");}}this.element.style.display="block";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"keypress",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar);}this.hideShowCovered();};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"keypress",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar);}this.element.style.display="none";this.hidden=true;this.hideShowCovered();};Calendar.prototype.showAt=function(x,y){var s=this.element.style;s.left=x+"px";s.top=y+"px";this.show();};Calendar.prototype.showAtElement=function(el,_d1){var _d2=this;var p=Calendar.getAbsolutePos(el);if(!_d1||typeof _d1!="string"){this.showAt(p.x,p.y+el.offsetHeight);return true;}function fixPosition(box){if(box.x<0){box.x=0;}if(box.y<0){box.y=0;}var cp=document.createElement("div");var s=cp.style;s.position="absolute";s.right=s.bottom=s.width=s.height="0px";document.body.appendChild(cp);var br=Calendar.getAbsolutePos(cp);document.body.removeChild(cp);if(Calendar.is_ie){br.y+=document.body.scrollTop;br.x+=document.body.scrollLeft;}else{br.y+=window.scrollY;br.x+=window.scrollX;}var tmp=box.x+box.width-br.x;if(tmp>0){box.x-=tmp;}tmp=box.y+box.height-br.y;if(tmp>0){box.y-=tmp;}}this.element.style.display="block";Calendar.continuation_for_the_fucking_khtml_browser=function(){var w=_d2.element.offsetWidth;var h=_d2.element.offsetHeight;_d2.element.style.display="none";var _db=_d1.substr(0,1);var _dc="l";if(_d1.length>1){_dc=_d1.substr(1,1);}switch(_db){case "T":p.y-=h;break;case "B":p.y+=el.offsetHeight;break;case "C":p.y+=(el.offsetHeight-h)/2;break;case "t":p.y+=el.offsetHeight-h;break;case "b":break;}switch(_dc){case "L":p.x-=w;break;case "R":p.x+=el.offsetWidth;break;case "C":p.x+=(el.offsetWidth-w)/2;break;case "l":p.x+=el.offsetWidth-w;break;case "r":break;}p.width=w;p.height=h+40;_d2.monthsCombo.style.display="none";fixPosition(p);_d2.showAt(p.x,p.y);};if(Calendar.is_khtml){setTimeout("Calendar.continuation_for_the_fucking_khtml_browser()",10);}else{Calendar.continuation_for_the_fucking_khtml_browser();}};Calendar.prototype.setDateFormat=function(str){this.dateFormat=str;};Calendar.prototype.setTtDateFormat=function(str){this.ttDateFormat=str;};Calendar.prototype.parseDate=function(str,fmt){if(!fmt){fmt=this.dateFormat;}this.setDate(Date.parseDate(str,fmt));};Calendar.prototype.hideShowCovered=function(){if(!Calendar.is_ie&&!Calendar.is_opera){return;}function getVisib(obj){var _e2=obj.style.visibility;if(!_e2){if(document.defaultView&&typeof (document.defaultView.getComputedStyle)=="function"){if(!Calendar.is_khtml){_e2=document.defaultView.getComputedStyle(obj,"").getPropertyValue("visibility");}else{_e2="";}}else{if(obj.currentStyle){_e2=obj.currentStyle.visibility;}else{_e2="";}}}return _e2;}var _e3=new Array("applet","iframe","select");var el=this.element;var p=Calendar.getAbsolutePos(el);var EX1=p.x;var EX2=el.offsetWidth+EX1;var EY1=p.y;var EY2=el.offsetHeight+EY1;for(var k=_e3.length;k>0;){var ar=document.getElementsByTagName(_e3[--k]);var cc=null;for(var i=ar.length;i>0;){cc=ar[--i];p=Calendar.getAbsolutePos(cc);var CX1=p.x;var CX2=cc.offsetWidth+CX1;var CY1=p.y;var CY2=cc.offsetHeight+CY1;if(this.hidden||(CX1>EX2)||(CX2<EX1)||(CY1>EY2)||(CY2<EY1)){if(!cc.__msh_save_visibility){cc.__msh_save_visibility=getVisib(cc);}cc.style.visibility=cc.__msh_save_visibility;}else{if(!cc.__msh_save_visibility){cc.__msh_save_visibility=getVisib(cc);}cc.style.visibility="hidden";}}}};Calendar.prototype._displayWeekdays=function(){var _f2=this.firstDayOfWeek;var _f3=this.firstdayname;var _f4=Calendar._TT["WEEKEND"];for(var i=0;i<7;++i){_f3.className="day name";var _f6=(i+_f2)%7;if(i){_f3.ttip=Calendar._TT["DAY_FIRST"].replace("%s",Calendar._DN[_f6]);_f3.calendar=this;_f3.fdow=_f6;if(this.firstDayButtons){_f3.navtype=100;Calendar._add_evs(_f3);}}if(_f4.indexOf(_f6.toString())!=-1){Calendar.addClass(_f3,"weekend");}_f3.innerHTML=Calendar._SDN[(i+_f2)%7];_f3=_f3.nextSibling;}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";if(this.yearButtons){this.yearsCombo.style.display="none";}};Calendar.prototype._dragStart=function(ev){if(this.dragging){return;}this.dragging=true;var _f8;var _f9;if(Calendar.is_ie){_f9=window.event.clientY+document.body.scrollTop;_f8=window.event.clientX+document.body.scrollLeft;}else{_f9=ev.clientY+window.scrollY;_f8=ev.clientX+window.scrollX;}var st=this.element.style;this.xOffs=_f8-parseInt(st.left);this.yOffs=_f9-parseInt(st.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd);}};Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1000;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date.parseDate=function(str,fmt){var _fd=new Date();var y=0;var m=-1;var d=0;var a=str.split(/\W+/);var b=fmt.match(/%./g);var i=0,j=0;var hr=0;var min=0;for(i=0;i<a.length;++i){if(!a[i]){continue;}switch(b[i]){case "%d":case "%e":d=parseInt(a[i],10);break;case "%m":m=parseInt(a[i],10)-1;break;case "%Y":case "%y":y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);break;case "%b":case "%B":for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){m=j;break;}}break;case "%H":case "%I":case "%k":case "%l":hr=parseInt(a[i],10);break;case "%P":case "%p":if(/pm/i.test(a[i])&&hr<12){hr+=12;}else{if(/am/i.test(a[i])&&hr>=12){hr-=12;}}break;case "%M":min=parseInt(a[i],10);break;}}if(isNaN(y)){y=_fd.getFullYear();}if(isNaN(m)){m=_fd.getMonth();}if(isNaN(d)){d=_fd.getDate();}if(isNaN(hr)){hr=_fd.getHours();}if(isNaN(min)){min=_fd.getMinutes();}if(y!=0&&m!=-1&&d!=0){return new Date(y,m,d,hr,min,0);}y=0;m=-1;d=0;for(i=0;i<a.length;++i){if(a[i].search(/[a-zA-Z]+/)!=-1){var t=-1;for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){t=j;break;}}if(t!=-1){if(m!=-1){d=m+1;}m=t;}}else{if(parseInt(a[i],10)<=12&&m==-1){m=a[i]-1;}else{if(parseInt(a[i],10)>31&&y==0){y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);}else{if(d==0){d=a[i];}}}}}if(y==0){y=_fd.getFullYear();}if(m!=-1&&d!=0){return new Date(y,m,d,hr,min,0);}return _fd;};Date.prototype.getMonthDays=function(_107){var year=this.getFullYear();if(typeof _107=="undefined"){_107=this.getMonth();}if(((0==(year%4))&&((0!=(year%100))||(0==(year%400))))&&_107==1){return 29;}else{return Date._MD[_107];}};Date.prototype.getDayOfYear=function(){var now=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var then=new Date(this.getFullYear(),0,0,0,0,0);var time=now-then;return Math.floor(time/Date.DAY);};Date.prototype.getWeekNumber=function(){var d=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var DoW=d.getDay();d.setDate(d.getDate()-(DoW+6)%7+3);var ms=d.valueOf();d.setMonth(0);d.setDate(4);return Math.round((ms-d.valueOf())/(7*86400000))+1;};Date.prototype.equalsTo=function(date){return ((this.getFullYear()==date.getFullYear())&&(this.getMonth()==date.getMonth())&&(this.getDate()==date.getDate())&&(this.getHours()==date.getHours())&&(this.getMinutes()==date.getMinutes()));};Date.prototype.setDateOnly=function(date){var tmp=new Date(date);this.setDate(1);this.setFullYear(tmp.getFullYear());this.setMonth(tmp.getMonth());this.setDate(tmp.getDate());};Date.prototype.print=function(str){var m=this.getMonth();var d=this.getDate();var y=this.getFullYear();var wn=this.getWeekNumber();var w=this.getDay();var s={};var hr=this.getHours();var pm=(hr>=12);var ir=(pm)?(hr-12):hr;var dy=this.getDayOfYear();if(ir==0){ir=12;}var min=this.getMinutes();var sec=this.getSeconds();s["%a"]=Calendar._SDN[w];s["%A"]=Calendar._DN[w];s["%b"]=Calendar._SMN[m];s["%B"]=Calendar._MN[m];s["%C"]=1+Math.floor(y/100);s["%d"]=(d<10)?("0"+d):d;s["%e"]=d;s["%H"]=(hr<10)?("0"+hr):hr;s["%I"]=(ir<10)?("0"+ir):ir;s["%j"]=(dy<100)?((dy<10)?("00"+dy):("0"+dy)):dy;s["%k"]=hr;s["%l"]=ir;s["%m"]=(m<9)?("0"+(1+m)):(1+m);s["%M"]=(min<10)?("0"+min):min;s["%n"]="\n";s["%p"]=pm?"PM":"AM";s["%P"]=pm?"pm":"am";s["%s"]=Math.floor(this.getTime()/1000);s["%S"]=(sec<10)?("0"+sec):sec;s["%t"]="\t";s["%U"]=s["%W"]=s["%V"]=(wn<10)?("0"+wn):wn;s["%u"]=w+1;s["%w"]=w;s["%y"]=(""+y).substr(2,2);s["%Y"]=y;s["%%"]="%";var re=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml){return str.replace(re,function(par){return s[par]||par;});}var a=str.match(re);for(var i=0;i<a.length;i++){var tmp=s[a[i]];if(tmp){re=new RegExp(a[i],"g");str=str.replace(re,tmp);}}return str;};Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(y){var d=new Date(this);d.__msh_oldSetFullYear(y);if(d.getMonth()!=this.getMonth()){this.setDate(28);}this.__msh_oldSetFullYear(y);};window._dynarch_popupCalendar=null;