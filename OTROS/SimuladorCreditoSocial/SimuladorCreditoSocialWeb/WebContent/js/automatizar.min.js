function aplicarEventos(a) {
  var b = $(a).data("tipo");
  "tipo_password" == b && ($(a).attr("maxlength", 32), $(a).blur(function () {
    var b = 6;
    "number" == typeof $(a).data("minlength") && (b = $(a).data("minlength")), aplicarClases(this, validarMinimo(this.value, b))
  })), "tipo_nombre" == b && ($(a).attr("maxlength", 30), $(a).blur(function () {
    this.value && !$(this).data("placeholder") || $(this).data("placeholder") && this.value != $(this).data("placeholder") ? aplicarClases(this, validarNombre(this.value)) : aplicarClases(this, "")
  })), "tipo_rut" == b && ($(a).attr("maxlength", 9), $(a).blur(function () {
    this.value && !$(this).data("placeholder") || $(this).data("placeholder") && this.value != $(this).data("placeholder") ? (formatearRut(this), aplicarClases(this, validarRut(this.value))) : aplicarClases(this, "")
  }), $(a).focus(function () {
    this.value = this.value.replace(/[^\dkK]/g, "")
  })), "tipo_telefono" == b && ($(a).attr("maxlength", 13), $(a).blur(function () {
    this.value == $(this).data("valueRequerido") ? aplicarClases(this, "") : aplicarClases(this, validarTelefono(this.value))
  }), bloquearCampo(a, "+56")), "tipo_email" == b && ($(a).attr("maxlength", 255), $(a).attr("type", "email"), $(a).blur(function () {
    this.value && !$(this).data("placeholder") || $(this).data("placeholder") && this.value != $(this).data("placeholder") ? aplicarClases(this, validarEmail(this.value)) : aplicarClases(this, "")
  }))
}

function obtenerPosicionCursor(a) {
  var b = 0;
  if (document.selection) {
    a.focus();
    var c = document.selection.createRange();
    c.moveStart("character", -a.value.length), b = c.text.length
  } else(a.selectionStart || "0" == a.selectionStart) && (b = a.selectionStart);
  return b
}

function bloquearCampo(a, b) {
  $(a).data("valueRequerido", b), $(a).val() || ($(a).data("placeholder") ? $(a).val($(a).data("placeholder")) : $(a).val("")), $(a).focus(function (a) {
    this.value || (this.value = $(this).data("valueRequerido"), setTimeout(function () {
      this.setSelectionRange(this.value.length, this.value.length)
    }.bind(this), 0))
  }), $(a).click(function (a) {
    this.value == $(this).data("valueRequerido") ? this.setSelectionRange(this.value.length, this.value.length) : this.selectionStart < $(this).data("valueRequerido").length && this.setSelectionRange($(this).data("valueRequerido").length, $(this).data("valueRequerido").length)
  }), $(a).keypress(function (b) {
    var c = b.which;
    return 0 === this.selectionStart && this.selectionEnd === this.value.length ? verificarPatron(b, a) : !(0 == obtenerPosicionCursor($(a)[0]) && $.inArray(c, habilitados) < 0) && void 0
  }), $(a).keydown(function (c) {
    var d = c.which,
      e = !0;
    return obtenerPosicionCursor($(a)[0]) == b.length ? 8 === d && (e = !1) : obtenerPosicionCursor($(a)[0]) < b.length && (0 === this.selectionStart && this.selectionEnd === this.value.length || 46 === d && (e = !1)), !!e && void $(this).data("textoAntes", this.value)
  }), $(a).keyup(function (a) {
    if (this.value == $(this).data("valueRequerido")) this.setSelectionRange(this.value.length, this.value.length);
    else if (this.selectionStart < $(this).data("valueRequerido").length) {
      var b = a.keyCode || a.which;
      9 != b && 16 != b ? this.setSelectionRange($(this).data("valueRequerido").length, $(this).data("valueRequerido").length) : this.setSelectionRange(this.value.length, this.value.length)
    }
    var c = this.value;
    0 != this.value.indexOf($(this).data("valueRequerido")) && (this.value && this.value != $(this).data("valueRequerido") ? 1 == c.length ? this.value = $(this).data("valueRequerido") + c : 0 == $(this).data("textoAntes").indexOf($(this).data("valueRequerido")) ? this.value = $(this).data("textoAntes") + this.value : this.value = $(this).data("valueRequerido") + $(this).data("textoAntes") : this.value = $(this).data("valueRequerido"))
  }), $(a).blur(function () {
    this.value == $(this).data("valueRequerido") && ($(a).data("placeholder") ? $(a).val($(a).data("placeholder")) : $(a).val(""))
  })
}

function aplicarClases(a, b) {
  var c = ["valido", "invalido"];
  for (i in c) {
    $(a).removeClass(c[i]);
    var d = $("#error_" + $(a).attr("id"));
    d.length > 0 && d.hide("fast")
  }
  if (b) {
    $(a).addClass(b);
    var d = $("#error_" + $(a).attr("id"));
    d.length > 0 && "invalido" == b ? d.show("fast") : d.hide("fast")
  }
}

function verificarPatron(a, b) {
  var c = $(b).data("tipo"),
    d = a.which;
  return !(!a.ctrlKey || 99 != d) || (!(!a.ctrlKey || 118 != d) || ($.inArray(d, habilitados) >= 0 || patrones[c].test(String.fromCharCode(d))))
}

function soportado(a, b) {
  var c = document.createElement(a);
  return b in c
}

function verificarDate() {
  var a = document.createElement("input");
  a.setAttribute("type", "date");
  var b = "not-a-date";
  return a.setAttribute("value", b), a.value !== b && /Mobi/.test(navigator.userAgent)
}

function formatearRut(a) {
  var b = new String(a.value);
  b = b.replace(/[^\dkK]/g, "");
  var c = b.substr(b.length - 1, 1);
  if (b = b.substr(0, b.length - 1), c.length && b.length) {
    var d = [];
    for (b = b.split(""), count = Math.ceil(b.length / 3) - 1, i = b.length - 1; i >= 0; i -= 3) num1 = b[i] ? b[i] : "", num2 = b[i - 1] ? b[i - 1] : "", num3 = b[i - 2] ? b[i - 2] : "", d[count] = num3 + num2 + num1, count--;
    b = d.join(".") + "-" + c, $(a).val(b)
  }
}

function validarRut(a) {
  if (!a) return "";
  var b = "invalido";
  if (a.length < 8) return b;
  if ("K" != a.substr(a.length - 1, 1) && "k" != a.substr(a.length - 1, 1)) {
    var c = a.substr(a.length - 1, 1);
    a = a.substr(0, a.length - 1)
  } else c = "K";
  a = a.replace(/\D/g, "");
  var d = a.length,
    e = 0,
    f = 2;
  for (d--; d >= 0;) e += a.charAt(d) * f, f > 6 ? f = 2 : f++, d--;
  var g = e % 11,
    h = 11 - g;
  return 10 == h && (h = "K"), 11 == h && (h = 0), b = a && c ? h != c ? "invalido" : "valido" : "invalido"
}

function validarTelefono(a) {
  if (!a) return "";
  var b = "invalido";
  return a.length >= 10 && (b = "valido"), b
}

function validarNombre(a) {
  if (!a) return "";
  var b = "invalido",
    c = a.split(" ");
  return c.length > 1 && "" != c[0] && "" != c[1] && a.length > 4 && (b = "valido"), b
}

function validarEmail(a) {
  var b = "valido",
    c = /^(.+\@.+\..+)$/;
  return c.test(a) || (b = "invalido"), b
}

function validarSelect(a) {
  return a ? "valido" : "invalido"
}

function validarBasico(a) {
  return a.length ? "valido" : "invalido"
}

function validarMinimo(a, b) {
  return a.length >= b ? "valido" : "invalido"
}

function formatearErrores(a, b, c) {
  for (b || (b = "Por favor ingrese su "), c || (c = "y"), i = 0; i < a.length; i++) b += a[i], i < a.length - 2 ? b += ", " : i == a.length - 2 && (b += " " + c + " ");
  return b
}

function validarFormulario(a, b) {
  "object" != typeof b && (b = {}), "undefined" == typeof b.action && (b.action = ""), "undefined" == typeof b.texto && (b.texto = ""), "undefined" == typeof b.separador && (b.separador = ""), "undefined" == typeof b.otrosCampos && (b.otrosCampos = {}), "function" != typeof b.exito && (b.exito = function () {
    $("#" + a).attr("action", b.action), $("#" + a).submit()
  }), "function" != typeof b.error && (b.error = function () {
    $("#errores_" + a).length > 0 ? ($("#errores_" + a).html(d), $("#errores_" + a).slideDown("fast"), toFormularios && clearTimeout(toFormularios), toFormularios = setTimeout(function () {
      $("#errores_" + a).slideUp("fast")
    }, 5e3)) : avisar(d)
  });
  var c = [];
  $("#" + a + " .requerido:visible").each(function (a, b) {
    $(b).blur();
    var d = 1;
    "password" == $(b).attr("type") || "date" == $(b).attr("type") || "email" == $(b).attr("type") || "text" == $(b).attr("type") || "select" == b.tagName.toLowerCase() || "textarea" == b.tagName.toLowerCase() ? $(b).hasClass("valido") || (d = 0) : "checkbox" != $(b).attr("type") && "radio" != $(b).attr("type") || (b.checked ? aplicarClases(b, "valido") : d = 0), d || (c.push($("label[for='" + $(b).attr("id") + "']").html()), aplicarClases(b, "invalido"))
  });
  for (i in b.otrosCampos) 0 == b.otrosCampos[i][0] ? (c.push(i), aplicarClases(b.otrosCampos[i][1], "invalido")) : aplicarClases(b.otrosCampos[i][1], "valido");
  if (c.length) {
    var d = formatearErrores(c, b.texto, b.separador);
    b.error()
  } else b.exito()
}

function limpiarFormulario(a) {
  $("#" + a)[0].reset(), $("#" + a + " :text, #" + a + " textarea, #" + a + " select").each(function (a, b) {
    $(b).removeClass("invalido"), $(b).removeClass("valido"), $(b).data("value") && $(b).val($(b).data("value")), $(b).data("placeHolder") && ($(b).addClass("sin_modificar"), $(b).val($(b).data("placeHolder"))), "#error_" + $(b).attr("id").length && $("#error_" + $(b).attr("id")).hide("fast")
  }), $("#errores_" + a).length && $("#errores_" + a).slideUp("fast")
}

function subir(a) {
  return "number" != typeof a && (a = 800), $("html, body").animate({
    scrollTop: 0
  }, a), !1
}

function paralaxes(a, b) {
  "object" != typeof b && (b = {}), "number" != typeof b.factor && (b.factor = 5), "number" != typeof b.offset && (b.offset = 0), a.each(function (a, c) {
    var d = $(c).find("img");
    $(c).css({
      position: "relative",
      overflow: "hidden"
    });
    var e = $(document).scrollTop() - $(c).offset().top;
    $(c).data("factor") || $(c).data("factor", b.factor), d.css({
      position: "absolute",
      top: e / $(c).data("factor") + b.offset,
      left: 0
    })
  }), $(document).scroll(function () {
    a.each(function (a, c) {
      var d = $(c).find("img"),
        e = b.factor;
      $(c).parent().data("factor") && (e = $(c).parent().data("factor"));
      var f = $(document).scrollTop() - $(c).offset().top;
      d.css({
        top: f / $(c).data("factor") + b.offset
      })
    })
  })
}

function popup(a, b) {
  "object" != typeof b && (b = {}), "number" != typeof b.width && (b.width = 640), "number" != typeof b.height && (b.height = 390), $(a).each(function (a, c) {
    $(c).click(function () {
      var a = $(this).attr("href"),
        c = screen.width / 2 - b.width / 2,
        d = screen.height / 2 - b.height / 2;
      return window.open(a, "", "width=" + b.width + ",height=" + b.height + ",location=no,menubar=no,scrollbars=no,directories=no,status=no,titlebar=no,toolbar=no,resizable=no,top=" + d + ",left=" + c), !1
    })
  })
}

function avisar(a, b) {
  sinTiempo = 0, 0 == b ? sinTiempo = 1 : "undefined" == typeof b && (b = 3e3), toAviso && (clearTimeout(toAviso), $("#aviso").length && $("#aviso").fadeOut("fast")), $("#aviso").length || $("body").append($("<div/>", {
    id: "aviso",
    style: "display:none;"
  })), $("#aviso").html(a), $("#aviso").fadeIn("fast"), sinTiempo || (toAviso = setTimeout(function () {
    $("#aviso").fadeOut("fast")
  }, b))
}
var version = "1.5.9",
  toAviso, toFormularios, habilitados = [0, 8, 13],
  dateHabilitado = verificarDate(),
  patrones = [];
patrones.tipo_alfanumerico = /\w/, patrones.tipo_numerico = /\d/, patrones.tipo_rut = /[kK0-9]/, patrones.tipo_email = /[a-zA-Z\@\.\-\_0-9]/, patrones.tipo_telefono = patrones.tipo_numerico, patrones.tipo_texto = /[a-zA-Z \-'áéíóúÁÉÍÓÚñÑäëïöüÄËÏÖÜâêîôûÂÊÎÔÛ]/, patrones.tipo_nombre = patrones.tipo_texto;
var antipatrones = [];
antipatrones.tipo_alfanumerico = /^\w/g, antipatrones.tipo_numerico = /^\d/g, antipatrones.tipo_rut = /[^kK0-9]/g, antipatrones.tipo_email = /[^a-zA-Z\@\.\-\_0-9]/g, antipatrones.tipo_telefono = patrones.tipo_numerico, antipatrones.tipo_texto = /[^a-zA-Z \-'áéíóúÁÉÍÓÚñÑäëïöüÄËÏÖÜâêîôûÂÊÎÔÛ]/g, antipatrones.tipo_nombre = patrones.tipo_texto, $(document).ready(function () {
  dateHabilitado && $(":text").each(function (a, b) {
    $(b).hasClass("calendario") && $(b).attr("readonly", !0)
  }), $(":text, :password, textarea, select").each(function (a, b) {
    var c = "";
    $(b).hasClass("requerido") && $(b).data("requerido", !0), "SELECT" != $(b).prop("tagName") ? c = $(b)[0].defaultValue : (c = $(b).find("option[selected]").val(), "undefined" == typeof c && (c = $(b).find("option:first").val())), $(b).data("value", c), $(b).val(c), $(b).focus(function () {
      $(this).addClass("activo")
    }), $(b).blur(function () {
      $(this).removeClass("activo"), "SELECT" == $(this).prop("tagName") && $(this).parent().hasClass("select") && $(this).parent().removeClass("activo")
    }), $(b).data("requerido") || $(b).blur(function () {
      $(this).hasClass("tipo_telefono") && "+" == this.value ? $(this).removeClass("requerido") : this.value ? ($(this).addClass("requerido"), aplicarClases(this, validarBasico(this.value))) : ($(this).removeClass("requerido"), aplicarClases(this, ""))
    })
  }), $(".select").each(function (a, b) {
    $(b).click(function () {
      $(this).addClass("activo")
    })
  }), $(":password").each(function (a, b) {
    $(b).data("tipo", "tipo_password"), aplicarEventos(b)
  }), $(":text, textarea").each(function (a, b) {
    soportado("textarea", "placeholder") || ($(b).data("placeholder", $(b).attr("placeholder")), $(b).val($(b).data("placeholder")), $(b).focus(function () {
      $(this).val() == $(b).data("placeholder") && ($(this).val(""), $(this).removeClass("sin_modificar"))
    }), $(b).blur(function () {
      "" == $(this).val() && ($(this).val($(b).data("placeholder")), $(this).addClass("sin_modificar"))
    }), $(b).addClass("sin_modificar"));
    for (key in patrones) $(b).hasClass(key) && ($(b).data("tipo", key), $(b).keypress(function (a) {
      return verificarPatron(a, this)
    }), $(b).bind("paste", function (a) {
      if (a.preventDefault(), "undefined" != typeof window.clipboardData) var c = window.clipboardData.getData("Text");
      else var c = a.originalEvent.clipboardData.getData("Text");
      $(b).val(c.replace(antipatrones[$(b).data("tipo")], ""))
    }), aplicarEventos(b));
    var c = ["tipo_email", "tipo_rut", "tipo_telefono", "tipo_nombre"],
      d = 1;
    if ($(b).hasClass("requerido")) {
      for (a in c) $(b).hasClass(c[a]) && (d = 0);
      d && $(b).blur(function () {
        aplicarClases(this, validarBasico(this.value))
      })
    }
  }), $("select").each(function (a, b) {
    $(b).hasClass("requerido") && $(b).val(""), $(this).change(function () {
      $(this).parent().hasClass("select") && (this.value ? aplicarClases($(this).parent(), validarSelect(this.value)) : aplicarClases($(this).parent(), "")), this.value ? aplicarClases(this, validarSelect(this.value)) : aplicarClases(this, "")
    })
  }), soportado("textarea", "maxLength") || $("textarea").each(function (a, b) {
    var c = $(b).attr("maxlength");
    $(b).keypress(function (a) {
      var b = a.which;
      return $.inArray(b, habilitados) >= 0 || !($(this).val().length >= c) && void 0
    })
  }), $(".hover").each(function (a, b) {
    $(b).mouseover(function () {
      $(this).addClass("hover")
    }), $(b).mouseout(function () {
      $(this).removeClass("hover")
    }), $(b).removeClass("hover")
  })
});